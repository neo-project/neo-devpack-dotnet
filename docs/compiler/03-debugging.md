# Debugging Information

Effective debugging is crucial for developing reliable smart contracts. The Neo C# Compiler (`nccs`) facilitates debugging by generating detailed mapping information when the `--debug` option is enabled.

## Enabling Debug Info Generation

To generate debugging information, use the `-d` or `--debug` flag during compilation:

```bash
nccs MyContractProject.csproj --debug
```

This command instructs the compiler to produce an additional output file.

## The `.nefdbgnfo` File

When debug generation is enabled, the compiler creates a file named `<BaseName>.nefdbgnfo` (e.g., `MyContract.nefdbgnfo`) in the output directory.

This file is a standard Zip archive containing one primary file:

*   **`<BaseName>.debug.json`**: A JSON file holding the actual debug metadata.

## The `.debug.json` File Format

The `.debug.json` file contains the core information needed by debuggers to correlate the compiled NeoVM bytecode with the original C# source code. Its structure typically includes:

*   **`hash`**: The script hash of the compiled contract (`.nef` file).
*   **`entrypoint`**: The instruction pointer (offset) of the contract's entry point.
*   **`documents`**: An array of paths to the original C# source files involved in the compilation.
*   **`methods`**: An array describing the compiled methods:
    *   **`id`**: A unique identifier for the method (e.g., `Namespace.ClassName,MethodName`).
    *   **`name`**: The method's name and signature.
    *   **`range`**: The start and end instruction offsets for the method's bytecode.
    *   **`params`**: An array listing the method's parameters (name and type).
    *   **`return`**: The method's return type.
    *   **`variables`**: An array listing the local variables within the method (name, type, and scope range).
    *   **`sequence-points`**: An array of critical mappings. Each point links a bytecode instruction offset to a specific location (document index, start line/column, end line/column) in the original C# source code. This is the core data used for stepping through code.
*   **`events`**: An array describing the events defined in the contract (similar structure to methods, listing parameters).
*   **`static-variables`**: An array listing static variables used in the contract.

*(Note: The exact JSON structure might evolve slightly between compiler versions, but the core concepts remain the same.)*

## Using Debug Information

The `.nefdbgnfo` file (containing the `.debug.json`) is essential for debugging tools like:

*   **Neo Debugger (Visual Studio Code Extension):** This tool reads the `.nefdbgnfo` file alongside the `.nef` and source code to allow setting breakpoints, stepping through C# code, inspecting variables, and examining the contract's state during execution in a simulated environment (like `Neo Express` or a `TestEngine`).
*   **Other Debugging Environments:** Custom testing or debugging setups can parse the `.debug.json` to provide similar source-level debugging capabilities.

Without the debug information generated by the `--debug` flag, debugging is limited to the NeoVM instruction level, which is significantly more complex and less intuitive than working directly with the C# source code.
